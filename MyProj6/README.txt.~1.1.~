this is the first submission before I could get everything working. I will add test cases as I get the full functionality working. Sorry!
